{% extends "pochopit/base.html" %}
{% load bootstrap3 %}
{% load staticfiles %}
{% load i18n %}

{% block title %}PochopIT{% endblock %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                <ul id="left-nav-tabs" class="nav nav-tabs nav-pills nav-stacked">
                    {% for tab in tabs %}
                        <li class="{{ tab.className }}" role="presentation">
                            <a id="{{ tab.shortName }}" href="#{{ tab.shortName }}" ajax_url="{{ tab.url }}" onclick="changeTab(this)">
                                {{ tab.title }}
                                {% if tab.addBaddge %}
                                    <span class="badge pull-right">{{ tab.baddgeNumber }}</span>
                                {% endif %}
                            </a>
                        </li>
                        {% if tab.isActive %}
                            <script>
                                $( document ).ready(function() {
                                    if (!window.location.hash) {
                                        var tabId = '#' + '{{ tab.shortName }}';
                                        window.location.hash = tabId;
                                        changeTab(jQuery(tabId)[0]);
                                    }
                                });
                            </script>
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
            <div class="col-md-9">
                <ul class="context-nav-bar">
                    {% for item in context_bar_items %}
                        <li><a href="{{ item.url }}">{{ item.title }}</a></li>
                    {% endfor %}
                </ul>
                <div id="tab-content">
                    {% block tab_content %}
                    {% endblock %}
                </div>
            </div>
        </div>
     </div>
    <script>
        function changeTab(element) {
            var content = jQuery('#tab-content');
            content.html('');
            content.load(jQuery(element).attr('ajax_url'));
            jQuery('#left-nav-tabs').find('li').removeClass('active');
            jQuery(element).closest('li').addClass('active');
        }

        if (window.location.hash) {
            var tabId = window.location.hash;
            changeTab(jQuery(tabId)[0]);
        }
    </script>
{% endblock %}